<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/guest/head}"><title></title></head>
<body>
<div th:replace="~{fragments/guest/navbar}"></div>
<!--Content Start-->
<div class="container">
    <div class="row g-5 mt-5">
        <div class="col-lg-3"></div>
        <div class="col-lg-6">
            <div class="border-start border-5 border-primary ps-5 mb-5" style="max-width: 600px;">
                <h1 class="display-5 text-uppercase mb-0">TẠO BÀI THI</h1>
            </div>
            <form th:action="@{/tao-bai-thi}" method="POST">
                <div class="row g-3">
                    <div class="col-12">
                        <label for="inp_exam-name" class="text-bold">Tên bài thi</label>
                        <input th:value="${examName}" id="inp_exam-name" name="examName" type="text"
                               class="form-control bg-light border-0 px-4 hexam-input-tag" placeholder="Nhập tên bài thi" required>
                    </div>

                    <div class="col-12">
                        <label for="tinymce" class="text-bold">Mô tả bài thi</label>
                        <textarea th:value="${examDescription}" name="projectData" id="tinymce"
                                  placeholder="Mô tả bài thi" class="form-control bg-light"></textarea>
                    </div>

                    <div class="col-12">
                        <label for="inp_exam-start-date" class="text-bold">Ngày bắt đầu</label>
                        <input th:value="${examStartDate}" id="inp_exam-start-date" name="startDate" type="text"
                               pattern="\d{2}/\d{2}/\d{4}" placeholder="dd/mm/yyyy"
                               class="form-control bg-light border-0 px-4 hexam-input-tag">
                    </div>

                    <div class="col-12">
                        <label for="inp_exam-end-date" class="text-bold">Ngày kết thúc</label>
                        <input th:value="${examEndDate}" id="inp_exam-end-date" name="endDate" type="text"
                               pattern="\d{2}/\d{2}/\d{4}" placeholder="dd/mm/yyyy"
                               class="form-control bg-light border-0 px-4 hexam-input-tag">
                        <small>*Bỏ trống nếu không muốn đặt ngày kết thúc cho bài thi</small>
                    </div>

                    <div class="col-12">
                        <label for="inp_exam-duration" class="text-bold">Thời gian làm bài</label>
                        <input th:value="${examDuration}" id="inp_exam-duration" name="duration" type="text"
                               placeholder="Nhập số phút" class="form-control bg-light border-0 px-4 hexam-input-tag">
                    </div>

                    <div class="col-12">
                        <label class="text-bold">Chế độ công khai</label>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="publication" id="btn_public"
                                   value="public">
                            <label class="form-check-label" for="btn_public">
                                Công khai - mọi người đều có thể làm bài
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="publication" id="btn_not-public"
                                   value="notPublic" checked>
                            <label class="form-check-label" for="btn_not-public">
                                Không công khai - chỉ dành cho lớp học của bạn
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="publication" id="btn_private"
                                   value="private">
                            <label class="form-check-label" for="btn_private">
                                Riêng tư - chỉ mình bạn
                            </label>
                        </div>
                    </div>

                    <div class="col-12">
                        <label for="inp_exam-attempts" class="text-bold">Số lần làm bài</label>
                        <input th:value="${examAttempts}" id="inp_exam-attempts" name="duration" type="text"
                               placeholder="Nhập số lần làm bài với mỗi học sinh" class="form-control bg-light border-0 hexam-input-tag">
                        <small>*Bỏ trống nếu không muốn giới hạn số lần làm bài thi.</small>
                    </div>

                    <div class="col-12">
                        <button class="btn btn-primary w-100 py-3" type="submit">TẠO BÀI THI</button>
                    </div>
                </div>
            </form>
        </div>
        <div class="col-lg-3"></div>
    </div>
</div>
<input type="hidden" id="toastMessage" th:value="${toastMessage}">
<div th:replace="~{fragments/guest/toast}"></div>
<!--Content End-->
<div th:replace="~{fragments/guest/footer}"></div>

<script>
    document.getElementById("btn_createClassSubmit").addEventListener("click", function () {
        // Reset previous error messages
        document.querySelectorAll('.err-msg').forEach(function (el) {
            el.style.display = 'none';
        });

        let className = document.getElementById("inp_className").value;

        let isContinueSubmit = true;

        if (className.trim().length < 3 || className.trim().length > 30) {
            document.getElementById("classNameError").innerText = "Tên lớp tối thiểu 3 ký tự và tối đa 30 ký tự.";
            document.getElementById("classNameError").style.display = 'block';
            isContinueSubmit = false;
        }

        if (isContinueSubmit) {
            document.getElementById("createClassForm").submit();
        }

    });
</script>

<script>
    document.getElementById("btn_joinClassSubmit").addEventListener("click", function () {
        // Reset previous error messages
        document.querySelectorAll('.err-msg').forEach(function (el) {
            el.style.display = 'none';
        });

        let className = document.getElementById("inp_joinCode").value;

        let isContinueSubmit = true;

        if (className.trim().length < 1) {
            document.getElementById("joinCodeError").innerText = "Mã tham gia không được bỏ trống!";
            document.getElementById("joinCodeError").style.display = 'block';
            isContinueSubmit = false;
        }

        if (isContinueSubmit) {
            document.getElementById("joinClassForm").submit();
        }

    });


</script>

<script>
    flatpickr("#inp_exam-start-date", {
        dateFormat: "d/m/Y"
    });
</script>
<script>
    flatpickr("#inp_exam-end-date", {
        dateFormat: "d/m/Y"
    });
</script>

<div th:replace="~{fragments/guest/scripts}"></div>
</body>
</html>